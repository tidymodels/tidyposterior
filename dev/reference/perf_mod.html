<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Bayesian Analysis of Resampling Statistics — perf_mod • tidyposterior</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/Source_Sans_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/Source_Code_Pro-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Bayesian Analysis of Resampling Statistics — perf_mod"><meta name="description" content="Bayesian analysis used here to answer the question: &quot;when looking at
resampling results, are the differences between models 'real?'&quot; To answer
this, a model can be created were the outcome is the resampling statistics
(e.g. accuracy or RMSE). These values are explained by the model types. In
doing this, we can get parameter estimates for each model's affect on
performance and make statistical (and practical) comparisons between models."><meta property="og:description" content="Bayesian analysis used here to answer the question: &quot;when looking at
resampling results, are the differences between models 'real?'&quot; To answer
this, a model can be created were the outcome is the resampling statistics
(e.g. accuracy or RMSE). These values are explained by the model types. In
doing this, we can get parameter estimates for each model's affect on
performance and make statistical (and practical) comparisons between models."><meta property="og:image" content="https://tidyposterior.tidymodels.org/logo.png"><meta name="robots" content="noindex"><script defer data-domain="tidyposterior.tidymodels.org,all.tidymodels.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#container" class="visually-hidden-focusable">Skip to content</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-none" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">tidyposterior</a>

    <small class="nav-text text-danger me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="In-development version">1.0.1.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/tidyposterior.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Getting_Started.html">Getting Started</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/tidymodels/tidyposterior/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic" id="container">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Bayesian Analysis of Resampling Statistics</h1>
      <small class="dont-index">Source: <a href="https://github.com/tidymodels/tidyposterior/blob/main/R/perf_mod.R" class="external-link"><code>R/perf_mod.R</code></a></small>
      <div class="d-none name"><code>perf_mod.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Bayesian analysis used here to answer the question: "when looking at
resampling results, are the differences between models 'real?'" To answer
this, a model can be created were the <em>outcome</em> is the resampling statistics
(e.g. accuracy or RMSE). These values are explained by the model types. In
doing this, we can get parameter estimates for each model's affect on
performance and make statistical (and practical) comparisons between models.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">perf_mod</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'rset'</span></span>
<span><span class="fu">perf_mod</span><span class="op">(</span><span class="va">object</span>, transform <span class="op">=</span> <span class="va">no_trans</span>, hetero_var <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'resamples'</span></span>
<span><span class="fu">perf_mod</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  transform <span class="op">=</span> <span class="va">no_trans</span>,</span>
<span>  hetero_var <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  metric <span class="op">=</span> <span class="va">object</span><span class="op">$</span><span class="va">metrics</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'data.frame'</span></span>
<span><span class="fu">perf_mod</span><span class="op">(</span><span class="va">object</span>, transform <span class="op">=</span> <span class="va">no_trans</span>, hetero_var <span class="op">=</span> <span class="cn">FALSE</span>, formula <span class="op">=</span> <span class="cn">NULL</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'tune_results'</span></span>
<span><span class="fu">perf_mod</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  metric <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transform <span class="op">=</span> <span class="va">no_trans</span>,</span>
<span>  hetero_var <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  filter <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S3 method for class 'workflow_set'</span></span>
<span><span class="fu">perf_mod</span><span class="op">(</span></span>
<span>  <span class="va">object</span>,</span>
<span>  metric <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  transform <span class="op">=</span> <span class="va">no_trans</span>,</span>
<span>  hetero_var <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  formula <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>Depending on the context (see Details below):</p><ul><li><p>A data frame with <code>id</code> columns for the resampling groupds and metric
results in all of the other columns..</p></li>
<li><p>An <code>rset</code> object (such as <code><a href="https://rsample.tidymodels.org/reference/vfold_cv.html" class="external-link">rsample::vfold_cv()</a></code>) containing the <code>id</code>
column(s) and at least two numeric columns of model performance
statistics (e.g. accuracy).</p></li>
<li><p>An object from <code>caret::resamples</code>.</p></li>
<li><p>An object with class <code>tune_results</code>, which could be produced by
<code><a href="https://tune.tidymodels.org/reference/tune_grid.html" class="external-link">tune::tune_grid()</a></code>, <code><a href="https://tune.tidymodels.org/reference/tune_bayes.html" class="external-link">tune::tune_bayes()</a></code> or similar.</p></li>
<li><p>A workflow set where all results contain the metric value given in the
<code>metric</code> argument value.</p></li>
</ul></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments to pass to <code><a href="https://mc-stan.org/rstanarm/reference/stan_glmer.html" class="external-link">rstanarm::stan_glmer()</a></code> such as
<code>verbose</code>, <code>prior</code>, <code>seed</code>, <code>refresh</code>, <code>family</code>, etc.</p></dd>


<dt id="arg-transform">transform<a class="anchor" aria-label="anchor" href="#arg-transform"></a></dt>
<dd><p>An named list of transformation and inverse
transformation functions. See <code><a href="transformations.html">logit_trans()</a></code> as an example.</p></dd>


<dt id="arg-hetero-var">hetero_var<a class="anchor" aria-label="anchor" href="#arg-hetero-var"></a></dt>
<dd><p>A logical; if <code>TRUE</code>, then different
variances are estimated for each model group. Otherwise, the
same variance is used for each group. Estimating heterogeneous
variances may slow or prevent convergence.</p></dd>


<dt id="arg-formula">formula<a class="anchor" aria-label="anchor" href="#arg-formula"></a></dt>
<dd><p>An optional model formula to use for the Bayesian hierarchical model
(see Details below).</p></dd>


<dt id="arg-metric">metric<a class="anchor" aria-label="anchor" href="#arg-metric"></a></dt>
<dd><p>A single character value for the statistic from
the <code>resamples</code> object that should be analyzed.</p></dd>


<dt id="arg-filter">filter<a class="anchor" aria-label="anchor" href="#arg-filter"></a></dt>
<dd><p>A conditional logic statement that can be used to filter the
statistics generated by <code>tune_results</code> using the tuning parameter values or
the <code>.config</code> column.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of class <code>perf_mod</code>. If a workfkow set is given in
<code>object</code>, there is an extra class of <code>"perf_mod_workflow_set"</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>These functions can be used to process and analyze matched
resampling statistics from different models using a Bayesian generalized
linear model with effects for the model and the resamples.</p><div class="section">
<h3 id="bayesian-model-formula">Bayesian Model formula<a class="anchor" aria-label="anchor" href="#bayesian-model-formula"></a></h3>


<p>By default, a generalized linear model with Gaussian error and an identity
link is fit to the data and has terms for the predictive model grouping
variable. In this way, the performance metrics can be compared between
models.</p>
<p>Additionally, random effect terms are also used. For most resampling
methods (except repeated <em>V</em>-fold cross-validation), a simple random
intercept model its used with an exchangeable (i.e. compound-symmetric)
variance structure. In the case of repeated cross-validation, two random
intercept terms are used; one for the repeat and another for the fold within
repeat. These also have exchangeable correlation structures.</p>
<p>The above model specification assumes that the variance in the performance
metrics is the same across models. However, this is unlikely to be true in
some cases. For example, for simple binomial accuracy, it well know that the
variance is highest when the accuracy is near 50 percent. When the argument
<code>hetero_var = TRUE</code>, the variance structure uses random intercepts for each
model term. This may produce more realistic posterior distributions but may
take more time to converge.</p>
<p>Examples of the default formulas are:</p>
<div class="sourceCode"><pre><code><span></span>
<span>   <span class="co"># One ID field and common variance:</span></span>
<span>     <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span> <span class="op">+</span> <span class="op">(</span><span class="va">model</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>   <span class="co"># One ID field and heterogeneous variance:</span></span>
<span>     <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span> <span class="op">+</span> <span class="op">(</span><span class="va">model</span> <span class="op">+</span> <span class="fl">0</span> <span class="op">|</span> <span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>   <span class="co"># Repeated CV (id = repeat, id2 = fold within repeat)</span></span>
<span>   <span class="co"># with a common variance:</span></span>
<span>     <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span> <span class="op">+</span> <span class="op">(</span><span class="va">model</span> <span class="op">|</span> <span class="va">id2</span><span class="op">/</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>   <span class="co"># Repeated CV (id = repeat, id2 = fold within repeat)</span></span>
<span>   <span class="co"># with a heterogeneous variance:</span></span>
<span>     <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span> <span class="op">+</span> <span class="op">(</span><span class="va">model</span> <span class="op">+</span> <span class="fl">0</span><span class="op">|</span> <span class="va">id2</span><span class="op">/</span><span class="va">id</span><span class="op">)</span></span>
<span></span>
<span>   <span class="co"># Default for unknown resampling method and</span></span>
<span>   <span class="co"># multiple ID fields:</span></span>
<span>     <span class="va">statistic</span> <span class="op">~</span> <span class="va">model</span> <span class="op">+</span> <span class="op">(</span><span class="va">model</span> <span class="op">|</span> <span class="va">idN</span><span class="op">/</span><span class="va">..</span><span class="op">/</span><span class="va">id</span><span class="op">)</span></span>
<span> </span></code></pre></div>

<p>Custom formulas should use <code>statistic</code> as the outcome variable and <code>model</code>
as the factor variable with the model names.</p>
<p>Also, as shown in the package vignettes, the Gaussian assumption make be
unrealistic. In this case, there are at least two approaches that can be
used. First, the outcome statistics can be transformed prior to fitting the
model. For example, for accuracy, the logit transformation can be used to
convert the outcome values to be on the real line and a model is fit to
these data. Once the posterior distributions are computed, the inverse
transformation can be used to put them back into the original units. The
<code>transform</code> argument can be used to do this.</p>
<p>The second approach would be to use a different error distribution from the
exponential family. For RMSE values, the Gamma distribution may produce
better results at the expense of model computational complexity. This can be
achieved by passing the <code>family</code> argument to <code>perf_mod</code> as one might with
the <code>glm</code> function.</p>
</div>

<div class="section">
<h3 id="input-formats">Input formats<a class="anchor" aria-label="anchor" href="#input-formats"></a></h3>


<p>There are several ways to give resampling results to the <code>perf_mod()</code> function. To
illustrate, here are some example objects using 10-fold cross-validation for a
simple two-class problem:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org" class="external-link">tidymodels</a></span><span class="op">)</span></span>
<span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyposterior.tidymodels.org">tidyposterior</a></span><span class="op">)</span></span>
<span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/tidymodels/workflowsets" class="external-link">workflowsets</a></span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">two_class_dat</span>, package <span class="op">=</span> <span class="st">"modeldata"</span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span>   <span class="va">folds</span> <span class="op">&lt;-</span> <span class="fu">vfold_cv</span><span class="op">(</span><span class="va">two_class_dat</span><span class="op">)</span></span></code></pre><p></p></div>
<p>We can define two different models (for simplicity, with no tuning parameters).</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="va">logistic_reg_glm_spec</span> <span class="op">&lt;-</span></span>
<span>     <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">set_engine</span><span class="op">(</span><span class="st">'glm'</span><span class="op">)</span></span>
<span></span>
<span>   <span class="va">mars_earth_spec</span> <span class="op">&lt;-</span></span>
<span>     <span class="fu">mars</span><span class="op">(</span>prod_degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">set_engine</span><span class="op">(</span><span class="st">'earth'</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">set_mode</span><span class="op">(</span><span class="st">'classification'</span><span class="op">)</span></span></code></pre><p></p></div>
<p>For tidymodels, the <code><a href="https://tune.tidymodels.org/reference/fit_resamples.html" class="external-link">tune::fit_resamples()</a></code> function can be used to estimate
performance for each model/resample:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="va">rs_ctrl</span> <span class="op">&lt;-</span> <span class="fu">control_resamples</span><span class="op">(</span>save_workflow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span></span>
<span>   <span class="va">logistic_reg_glm_res</span> <span class="op">&lt;-</span></span>
<span>     <span class="va">logistic_reg_glm_spec</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">fit_resamples</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, resamples <span class="op">=</span> <span class="va">folds</span>, control <span class="op">=</span> <span class="va">rs_ctrl</span><span class="op">)</span></span>
<span></span>
<span>   <span class="va">mars_earth_res</span> <span class="op">&lt;-</span></span>
<span>     <span class="va">mars_earth_spec</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">fit_resamples</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, resamples <span class="op">=</span> <span class="va">folds</span>, control <span class="op">=</span> <span class="va">rs_ctrl</span><span class="op">)</span></span></code></pre><p></p></div>
<p>From these, there are several ways to pass the results to <code>perf_mod()</code>.</p><div class="section">
<h4 id="data-frame-as-input">Data Frame as Input<a class="anchor" aria-label="anchor" href="#data-frame-as-input"></a></h4>


<p>The most general approach is to have a data frame with the resampling labels (i.e.,
one or more id columns) as well as columns for each model that you would like to
compare.</p>
<p>For the model results above, <code><a href="https://tune.tidymodels.org/reference/collect_predictions.html" class="external-link">tune::collect_metrics()</a></code> can be used along with some
basic data manipulation steps:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="va">logistic_roc</span> <span class="op">&lt;-</span></span>
<span>     <span class="fu"><a href="https://tune.tidymodels.org/reference/collect_predictions.html" class="external-link">collect_metrics</a></span><span class="op">(</span><span class="va">logistic_reg_glm_res</span>, summarize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.metric</span> <span class="op">==</span> <span class="st">"roc_auc"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, logistic <span class="op">=</span> <span class="va">.estimate</span><span class="op">)</span></span>
<span></span>
<span>   <span class="va">mars_roc</span> <span class="op">&lt;-</span></span>
<span>     <span class="fu"><a href="https://tune.tidymodels.org/reference/collect_predictions.html" class="external-link">collect_metrics</a></span><span class="op">(</span><span class="va">mars_earth_res</span>, summarize <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">.metric</span> <span class="op">==</span> <span class="st">"roc_auc"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">id</span>, mars <span class="op">=</span> <span class="va">.estimate</span><span class="op">)</span></span>
<span></span>
<span>   <span class="va">resamples_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">logistic_roc</span>, <span class="va">mars_roc</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span>   <span class="va">resamples_df</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>   <span class="do">## # A tibble: 10 x 3</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   <span class="do">##   id     logistic  mars</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>   <span class="do">##   &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="do">## 1 Fold01    0.908 0.875</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>   <span class="do">## 2 Fold02    0.904 0.917</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>   <span class="do">## 3 Fold03    0.924 0.938</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>   <span class="do">## 4 Fold04    0.881 0.881</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>   <span class="do">## 5 Fold05    0.863 0.864</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>   <span class="do">## 6 Fold06    0.893 0.889</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>   <span class="do">## # … with 4 more rows</span></span></code></pre><p></p></div>
<p>We can then give this directly to <code>perf_mod()</code>:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span>   <span class="va">roc_model_via_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf_mod.html">perf_mod</a></span><span class="op">(</span><span class="va">resamples_df</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">roc_model_via_df</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>   <span class="do">## # A tibble: 2 x 4</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   <span class="do">##   model     mean lower upper</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>   <span class="do">##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="do">## 1 logistic 0.892 0.879 0.906</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>   <span class="do">## 2 mars     0.888 0.875 0.902</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h4 id="rsample-object-as-input">rsample Object as Input<a class="anchor" aria-label="anchor" href="#rsample-object-as-input"></a></h4>


<p>Alternatively, the result columns can be merged back into the original <code>rsample</code>
object. The up-side to using this method is that <code>perf_mod()</code> will know exactly
which model formula to use for the Bayesian model:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="va">resamples_rset</span> <span class="op">&lt;-</span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">folds</span>, <span class="va">logistic_roc</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>     <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html" class="external-link">full_join</a></span><span class="op">(</span><span class="va">mars_roc</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span>   <span class="va">roc_model_via_rset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf_mod.html">perf_mod</a></span><span class="op">(</span><span class="va">resamples_rset</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">roc_model_via_rset</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>   <span class="do">## # A tibble: 2 x 4</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   <span class="do">##   model     mean lower upper</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>   <span class="do">##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="do">## 1 logistic 0.892 0.879 0.906</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>   <span class="do">## 2 mars     0.888 0.875 0.902</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h4 id="workflow-set-object-as-input">Workflow Set Object as Input<a class="anchor" aria-label="anchor" href="#workflow-set-object-as-input"></a></h4>


<p>Finally, for tidymodels, a workflow set object can be used. This is a collection of
models/preprocessing combinations in one object. We can emulate a workflow set using
the existing example results then pass that to <code>perf_mod()</code>:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="va">example_wset</span> <span class="op">&lt;-</span></span>
<span>     <span class="fu"><a href="https://workflowsets.tidymodels.org/reference/as_workflow_set.html" class="external-link">as_workflow_set</a></span><span class="op">(</span>logistic <span class="op">=</span> <span class="va">logistic_reg_glm_res</span>, mars <span class="op">=</span> <span class="va">mars_earth_res</span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span>   <span class="va">roc_model_via_wflowset</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf_mod.html">perf_mod</a></span><span class="op">(</span><span class="va">example_wset</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">roc_model_via_rset</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>   <span class="do">## # A tibble: 2 x 4</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   <span class="do">##   model     mean lower upper</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>   <span class="do">##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="do">## 1 logistic 0.892 0.879 0.906</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>   <span class="do">## 2 mars     0.888 0.875 0.902</span></span></code></pre><p></p></div>
</div>

<div class="section">
<h4 id="caret-resamples-object">caret resamples object<a class="anchor" aria-label="anchor" href="#caret-resamples-object"></a></h4>


<p>The <code>caret</code> package can also be used. An equivalent set of models are created:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/" class="external-link">caret</a></span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">102</span><span class="op">)</span></span>
<span>   <span class="va">logistic_caret</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">two_class_dat</span>, method <span class="op">=</span> <span class="st">"glm"</span>,</span>
<span>                           trControl <span class="op">=</span> <span class="fu">trainControl</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cv"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">102</span><span class="op">)</span></span>
<span>   <span class="va">mars_caret</span> <span class="op">&lt;-</span> <span class="fu">train</span><span class="op">(</span><span class="va">Class</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="va">two_class_dat</span>, method <span class="op">=</span> <span class="st">"gcvEarth"</span>,</span>
<span>                       tuneGrid <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>degree <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                       trControl <span class="op">=</span> <span class="fu">trainControl</span><span class="op">(</span>method <span class="op">=</span> <span class="st">"cv"</span><span class="op">)</span><span class="op">)</span></span></code></pre><p></p></div>
<p>Note that these two models use the same resamples as one another due to setting the
seed prior to calling <code>train()</code>. However, these are different from the tidymodels
results used above (so the final results will be different).</p>
<p><code>caret</code> has a <code>resamples()</code> function that can collect and collate the resamples.
This can also be given to <code>perf_mod()</code>:</p>
<p></p><div class="sourceCode r"><pre><code><span>   <span class="va">caret_resamples</span> <span class="op">&lt;-</span> <span class="fu">resamples</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>logistic <span class="op">=</span> <span class="va">logistic_caret</span>, mars <span class="op">=</span> <span class="va">mars_caret</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span>   <span class="fu"><a href="https://rdrr.io/r/base/Random.html" class="external-link">set.seed</a></span><span class="op">(</span><span class="fl">101</span><span class="op">)</span></span>
<span>   <span class="va">roc_model_via_caret</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/perf_mod.html">perf_mod</a></span><span class="op">(</span><span class="va">caret_resamples</span>, refresh <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span>   <span class="fu"><a href="https://generics.r-lib.org/reference/tidy.html" class="external-link">tidy</a></span><span class="op">(</span><span class="va">roc_model_via_caret</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span></span></code></pre><p></p></div>
<p></p><div class="sourceCode"><pre><code><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>   <span class="do">## # A tibble: 2 x 4</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>   <span class="do">##   model     mean lower upper</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>   <span class="do">##   &lt;chr&gt;    &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>   <span class="do">## 1 logistic 0.821 0.801 0.842</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>   <span class="do">## 2 mars     0.822 0.802 0.842</span></span></code></pre><p></p></div>
</div>


</div>

    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Kuhn and Silge (2021) <em>Tidy Models with R</em>, Chapter 11,
<a href="https://www.tmwr.org/compare.html" class="external-link">https://www.tmwr.org/compare.html</a></p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="tidy.perf_mod.html">tidy.perf_mod()</a></code>, <code><a href="contrast_models.html">contrast_models()</a></code></p></div>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


   </div>
  <footer><div class="container">
  <div class="pkgdown-footer-left">
  <p>Developed by <a href="https://github.com/topepo" class="external-link">Max Kuhn</a>, <a href="https://www.posit.co" class="external-link"><img src="https://www.tidyverse.org/posit-logo.svg" alt="Posit" height="16" width="62" style="margin-bottom: 3px;"></a>.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

  </div></footer></body></html>

